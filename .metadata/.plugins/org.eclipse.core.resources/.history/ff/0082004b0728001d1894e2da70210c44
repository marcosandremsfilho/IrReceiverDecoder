#include "main.h"
#include "sensorIrClass.h"

void SensorIR::getTime(uint16_t microseconds) {
	time = microseconds;
	microsecondstime = 0;
	if(time > 10000 || flag == 1){
		flag = 1;
		decodeSignalFunction();
	}
}

void SensorIR::decodeSignalFunction() {
			if(flag == 1){
				timeSignal[bit] = time;
				bit++;
			}
		if(bit >= 32){
			for(int j = 0; j < 32; j++){
				if((timeSignal[j] > 100 && timeSignal[j] < 120)) {
					decodeSignal = (decodeSignal << 1) + 1;
				} else if (timeSignal[j] > 210 && timeSignal[j] < 230) {
					decodeSignal = decodeSignal << 1;
				}
			}
			bit = 0;
			flag = 0;
			decode = decodeSignal;
			if (decodeSignal > 0 && decodeSignal < 2140000000) {
				Signal = decodeSignal;
				HAL_GPIO_WritePin(LED1_GPIO_Port, LED1_Pin, GPIO_PIN_SET);
			} else {
				return;
			}
			decodeSignal = 0;
}
}

